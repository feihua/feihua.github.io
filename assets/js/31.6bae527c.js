(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{453:function(s,a,t){s.exports=t.p+"assets/img/img.508a4689.png"},482:function(s,a,t){"use strict";t.r(a);var n=t(15),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"kong网关安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kong网关安装"}},[s._v("#")]),s._v(" kong网关安装")]),s._v(" "),a("p",[a("strong",[s._v("安装环境")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("软件")]),s._v(" "),a("th",[s._v("版本")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("Red Hat Enterprise Linux")]),s._v(" "),a("td",[s._v("8")])]),s._v(" "),a("tr",[a("td",[s._v("postgresql")]),s._v(" "),a("td",[s._v("16")])]),s._v(" "),a("tr",[a("td",[s._v("kong")]),s._v(" "),a("td",[s._v("3.7.1")])])])]),s._v(" "),a("p",[s._v("kong安装主要涉及存储和它本身")]),s._v(" "),a("h2",{attrs:{id:"_1-postgresql-数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-postgresql-数据库"}},[s._v("#")]),s._v(" 1.postgresql 数据库")]),s._v(" "),a("h3",{attrs:{id:"_1-1安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1安装"}},[s._v("#")]),s._v(" 1.1安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".安装\nyum module "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" postgresql:16/server\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".初始化\npostgresql-setup "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--initdb")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".启动\nsystemctl start postgresql.service\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".开机启动\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" postgresql.service\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".状态查看\nsystemctl status postgresql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"_2-配置远程访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置远程访问"}},[s._v("#")]),s._v(" 2.配置远程访问")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /var/lib/pgsql/data/postgresql.conf\n\n\n将 listen_addresses 设置为 * 以监听所有接口，或者指定具体的 IP 地址\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /var/lib/pgsql/data/pg_hba.conf 文件，添加允许远程连接的行\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("    all             all             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0/0               md5\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("span",{staticStyle:{color:"red"}},[s._v("配置完后（要重启）")])]),s._v(" "),a("h3",{attrs:{id:"_3-连接数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-连接数据库"}},[s._v("#")]),s._v(" 3.连接数据库")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" postgres psql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4-kong相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-kong相关"}},[s._v("#")]),s._v(" 4.kong相关")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" kong "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" PASSWORD "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'super_secret'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" kong OWNER kong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("span",{staticStyle:{color:"red"}},[s._v("这个配置后面kong配置的时候要用")])]),s._v(" "),a("h3",{attrs:{id:"_5-修改默认密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改默认密码"}},[s._v("#")]),s._v(" 5.修改默认密码")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("ALTER "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" postgres WITH PASSWORD "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'newpassword'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_2-kong安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-kong安装"}},[s._v("#")]),s._v(" 2.kong安装")]),s._v(" "),a("h3",{attrs:{id:"_2-1安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1安装"}},[s._v("#")]),s._v(" 2.1安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". 下载\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Lo")]),s._v(" kong-3.7.1.rpm "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--eval")]),s._v(" https://packages.konghq.com/public/gateway-37/rpm/el/%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("rhel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_arch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/kong-3.7.1.el%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("rhel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(".%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("_arch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(".rpm"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" kong-3.7.1.rpm\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". 配置存储\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/kong/kong.conf.default /etc/kong/kong.conf\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/kong/kong.conf 修改pg配置即可\n\npg_host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1    \npg_user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" kong            \npg_password "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" kong                 \npg_database "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" kong            \n\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". 初始化\nkong migrations bootstrap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" /etc/kong/kong.conf\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". 启动\nkong start "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" /etc/kong/kong.conf\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(". 验证\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" http://localhost:8001\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("kong manager管理界面")])]),s._v(" "),a("p",[s._v("http://localhost:8002")]),s._v(" "),a("p",[a("img",{attrs:{src:t(453),alt:"img.png"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);